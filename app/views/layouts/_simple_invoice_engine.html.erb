<div class="primary_header">
  <div class="logo">
    <%= link_to image_tag("logo.png", :size => "218x30"), get_url %>
  </div>
  <div class="primary_menu">

    <div class="dropdown">
      <a class="dropdown-toggle" data-toggle="dropdown" href="#"><%= current_user.user_name || current_user.email %>
        <b class="caret"></b></a>
      <div class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu">
        <div class="top_arrow"><%=image_tag "dd_top.png" %></div>
        <ul>
          <li><%= link_to "Edit Profile", main_app.new_account_path, tabindex: "-1" %></li>
          <li><%= link_to "Change password", main_app.edit_user_registration_path, tabindex: "-1" %></li>
          <li><%= link_to "Logout", main_app.destroy_user_session_path, :method => :delete, tabindex: "-1" %></li>
        </ul>
      </div>
    </div>

    <div class="dropdown_sep"></div>

    <div class="dropdown">
      <a  class="dropdown-toggle" data-toggle="dropdown" href="#">
        <span id="current_selected_company"><%= get_company_name %></span>
        <b class="caret"></b>
      </a>
      <div class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu">
        <div class="top_arrow"><%= image_tag "dd_top.png" %></div>
        <%= companies = current_user.current_account.companies
            content_tag(:ul) do
              companies.each do |company|
                params[:company_id] = company.id
                if params[:controller] == "dashboard"
                  url_param = "javascript:"
                  remote_status = false
                else
                  url_param = url_for(params: params)
                  remote_status = true
                end
                link_options = {:remote => remote_status, :class => 'header_company_link', :company_id => company.id, :controller => params[:controller], :action => params[:action]}
                concat(content_tag(:li) { link_to(company.company_name, url_param, link_options) })
              end
            end %>
      </div>
    </div>

  </div>
</div>
<!--header-->

<div class="navigation">
  <div class="nav_container">
    <div id="nav">
      <ul class="select">
        <li><%= active_link_to t("header.links.dashboard"), get_url %></li>

        <li class="dropdown">
          <%= active_link_to t("header.links.invoices.invoices"), invoices_path, :class => "dropdown-toggle disabled", "data-toggle" => "dropdown" %>
          <ul class="sub">
            <li><%= active_link_to t("header.links.invoices.invoices"), invoices_path %></li>
            <li><%= active_link_to t("header.links.invoices.recurring"), main_app.recurring_profiles_path %></li>
          </ul>
          <div class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu">
            <ul>
              <li><%= active_link_to t("header.links.invoices.listing"), invoices_path %></li>
              <li><%= active_link_to t("header.links.invoices.new"), new_invoice_path %></li>
              <li><%= active_link_to t("header.links.invoices.recurring"), main_app.recurring_profiles_path %></li>
            </ul>
          </div>
        </li>
        <li class="dropdown">
          <%= active_link_to "Estimates", main_app.estimates_path, :class => "dropdown-toggle disabled", "data-toggle" => "dropdown" %>
          <ul class="sub">
            <li><%= active_link_to "Estimates", main_app.estimates_path %></li>
            <li><%= active_link_to "New Estimate", main_app.new_estimate_path %></li>
          </ul>
          <div class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu">
            <ul>
              <li><%= active_link_to "Estimate Listing", main_app.estimates_path %></li>
              <li><%= active_link_to "New Estimate", main_app.new_estimate_path %></li>
            </ul>
          </div>
        </li>
        <li class="dropdown">
          <%= active_link_to t("header.links.time_tracking.time_tracking"), main_app.logs_path, :class => "dropdown-toggle disabled", "data-toggle" => "dropdown" %>
          <ul class="sub">
            <li><%= active_link_to t("header.links.time_tracking.time_sheet"), main_app.logs_path %></li>
            <li><%= active_link_to t("header.links.time_tracking.project"), main_app.projects_path %></li>
            <li><%= active_link_to t("header.links.time_tracking.task"), main_app.tasks_path %></li>
            <li><%= active_link_to t("header.links.time_tracking.staff"), main_app.staffs_path %></li>
            <li><%= active_link_to t("header.links.time_tracking.invoice"), main_app.invoice_logs_path %></li>
          </ul>
          <div class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu">
            <ul>
              <li><%= active_link_to t("header.links.time_tracking.time_sheet"), main_app.logs_path %></li>
              <li><%= active_link_to t("header.links.time_tracking.project"), main_app.projects_path %></li>
              <li><%= active_link_to t("header.links.time_tracking.task"), main_app.tasks_path %></li>
              <li><%= active_link_to t("header.links.time_tracking.staff"), main_app.staffs_path %></li>
              <li><%= active_link_to t("header.links.time_tracking.invoice"), main_app.invoice_logs_path %></li>

            </ul>
          </div>
        </li>

        <li class="dropdown">
          <%= active_link_to t("header.links.expenses.expenses"), main_app.expenses_path, :class => "dropdown-toggle disabled", "data-toggle" => "dropdown"  %>
          <ul class="sub">
            <li><%= active_link_to t("header.links.expenses.listing"), "/#{I18n.locale}/expenses" %></li>
            <li><%= active_link_to t("header.links.expenses.new"), "/#{I18n.locale}/expenses/new" %></li>
          </ul>
          <div class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu">
            <ul>
              <li><%= active_link_to t("header.links.expenses.listing"), "/#{I18n.locale}/expenses" %></li>
              <li><%= active_link_to t("header.links.expenses.new"), "/#{I18n.locale}/expenses/new" %></li>

            </ul>
          </div>
        </li>

        <li class="dropdown">
          <%= active_link_to t("header.links.clients.clients"), main_app.clients_path, :class => "dropdown-toggle disabled", "data-toggle" => "dropdown"  %>
          <ul class="sub">
            <li><%= active_link_to t("header.links.clients.clients"), main_app.clients_path %></li>
            <li><%= active_link_to t("header.links.clients.sent_emails"), main_app.sent_emails_path %></li>
          </ul>
          <div class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu">
            <ul>
              <li><%= active_link_to t("header.links.clients.listing"), main_app.clients_path %></li>
              <li><%= active_link_to t("header.links.clients.new"), main_app.new_client_path %></li>
              <li><%= active_link_to t("header.links.clients.sent_emails"), main_app.sent_emails_path %></li>
            </ul>
          </div>
        </li>

        <li class="dropdown">
          <%= active_link_to t("header.links.items.items"), main_app.items_path, :class => "dropdown-toggle disabled", "data-toggle" => "dropdown"  %>
          <ul class="sub">
            <li><%= active_link_to t("header.links.items.items"), main_app.items_path %></li>
            <li><%= active_link_to t("header.links.items.taxes"), main_app.taxes_path %></li>
          </ul>
          <div class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu">
            <ul>
              <li><%= active_link_to t("header.links.items.listing"), main_app.items_path %></li>
              <li><%= active_link_to t("header.links.items.new"), main_app.new_item_path %></li>
              <li><%= active_link_to t("header.links.items.taxes"), main_app.taxes_path %></li>
            </ul>
          </div>
        </li>

        <li class="dropdown">
          <%= active_link_to t("header.links.payments.payments"), main_app.payments_path, :class => "dropdown-toggle disabled", "data-toggle" => "dropdown"  %>
          <div class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu">
            <ul>
              <li><%= active_link_to t("header.links.payments.listing"), main_app.payments_path %></li>
              <li><%= active_link_to t("header.links.payments.new"), '/invoices/unpaid_invoices', "data-toggle" => "modal", "data-target" => "#myModal", :remote => true  %></li>
            </ul>
          </div>
        </li>
        <% if can?(:manage, Reporting) %>
            <li class="dropdown">
              <%= active_link_to t("header.links.reports.reports"), main_app.reports_path, :class => "dropdown-toggle disabled", "data-toggle" => "dropdown"  %>
              <div class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu">
                <ul>
                  <li><%= active_link_to t("header.links.reports.payment_collected"), "/#{I18n.locale}/reports/payments_collected" %></li>
                  <li><%= active_link_to t("header.links.reports.revenue_by_client"), "/#{I18n.locale}/reports/revenue_by_client" %></li>
                  <li><%= active_link_to t("header.links.reports.aged_account_receivable"), "/#{I18n.locale}/reports/aged_accounts_receivable" %></li>
                  <li><%= active_link_to t("header.links.reports.item_sales"), "/#{I18n.locale}/reports/item_sales" %></li>
                  <li><%= active_link_to t("header.links.reports.invoice_detail"), "/#{I18n.locale}/reports/invoice_detail" %></li>
                </ul>
              </div>
            </li>
        <% end %>
        <li class="dropdown">
          <%= active_link_to t("header.links.setting.setting"), main_app.companies_path, :class => "dropdown-toggle disabled", "data-toggle" => "dropdown"  %>

          <ul class="sub">
            <li><%= active_link_to t("header.links.setting.companies"), main_app.companies_path %></li>
            <li><%= active_link_to t("header.links.setting.term_rules"), term_rules_path %></li>
            <li><%= active_link_to t("header.links.setting.penalty_rules"), penalty_rules_path %></li>
            <li class="secondary"><%= active_link_to t("header.links.setting.email_templates"), main_app.email_templates_path %></li>
            <% if can?(:manage, User) %>
                <li class="secondary_02"><%= link_to t("header.links.setting.users"), main_app.sub_users_path,class: "#{'active' if params[:controller] == 'sub_users' and params[:action] != 'user_settings'}" %></li>
            <% end %>
            <li class="secondary_03"><%= link_to t("header.links.setting.basic_settings"), main_app.user_settings_sub_users_path,class: "#{'active' if params[:action]=='user_settings'}" %></li>
            <li class="secondary_04"><%= active_link_to  t("header.links.setting.import_data"), main_app.import_data_path %></li>
          </ul>
          <div class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu">
            <ul>
              <li><%= active_link_to  t("header.links.setting.companies"), main_app.companies_path %></li>
              <li><%= active_link_to  t("header.links.setting.email_templates"), main_app.email_templates_path %></li>
              <% if can?(:manage, User) %>
                  <li><%= active_link_to  t("header.links.setting.users"), main_app.sub_users_path %></li>
              <% end %>

              <li><%= active_link_to  t("header.links.setting.basic_settings"), main_app.user_settings_sub_users_path %></li>
              <li><%= active_link_to  t("header.links.setting.import_data"), main_app.import_data_path %></li>
              <li><%= active_link_to  t("header.links.setting.term_rules"), term_rules_path %></li>
              <li><%= active_link_to  t("header.links.setting.penalty_rules"), penalty_rules_path %></li>
            </ul>
          </div>
        </li>

        <li><%= active_link_to  t("header.links.help"), main_app.help_index_path %></li>
      </ul>
    </div>
  </div>
</div>
<!-- NAVIGATION END -->
